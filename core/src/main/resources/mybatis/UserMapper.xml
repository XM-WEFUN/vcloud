<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bootvue.core.mapper.UserMapper">
    <select id="listUsers" resultType="com.bootvue.core.ddo.user.UserDo">
        SELECT u.id          id,
               u.username    username,
               r.`name`      role,
               u.`status`    status,
               u.create_time create_time
        FROM `user` u
                     LEFT JOIN role r ON (u.tenant_id = #{tenantId} and u.role_id = r.id)
                where u.role_id != -1
                  and u.delete_time is null
        <if test="username != null and username != ''">
            and u.username = concat('%', #{username}, '%')
        </if>
        order by u.create_time desc
    </select>
</mapper>